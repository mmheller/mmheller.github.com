<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>GNLCC Project Tracking System Public Website</title>
    <!-- CSS -->
    <link rel="stylesheet" href="https://js.arcgis.com/3.13/dijit/themes/soria/soria.css" type="text/css">
    <link rel="stylesheet" href="https://js.arcgis.com/3.13/esri/css/esri.css"/>
    <link rel="stylesheet" href="css/github.css" type="text/css" />
    <link rel="stylesheet" href="css/demo.css" type="text/css" />
    <!--<link rel="stylesheet" href="https://js.arcgis.com/3.13/dojox/grid/resources/Grid.css">-->
    <link rel="stylesheet" href="css/Grid.css" type="text/css">
    <!--<link rel="stylesheet" href="https://js.arcgis.com/3.13/dojox/grid/resources/soriaGrid.css" type="text/css">-->

    <!--<link rel="stylesheet" href="https://js.arcgis.com/3.13/esri/css/claro.css"/>-->

    <!-- /CSS -->

<script type="text/javascript">var dojoConfig = {paths: { extras: location.pathname.replace(/\/[^/]+$/, "") + "/extras" }};</script>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<!--<script type="text/javascript" src="extras/jquery.min.js"></script>-->
<script type="text/javascript" src="http://softwaremaniacs.org/media/soft/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="extras/jquery.cookie.js"></script>
<script type="text/javascript" src="extras/jquery.collapsible.js"></script>
<script type="text/javascript" src="https://js.arcgis.com/3.13/"></script>

<style>

    .soria .dojoxGridRowOver .dojoxGridCell { color:#000000; }

    div.columns       { width: 650px;   margin: 0 auto;}
    div.columns div   { width: 325px; float: left; }
    div.grey          { background-color: #cccccc; }
    div.red           { background-color: #e14e32; }
    div.clear         { clear: both; }

    div.scroll {
        height: 250px;
        overflow-y: scroll;
        background:#f0f0f0;
        margin: 0;
        padding:10px;
        font-size:.8em;
        line-height:1.5em;
        font-family:"Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;
    }

    html,body 
    {
    height:100%;      
    width:100%;      
    margin:0;      
    }
    body {
    background-color:#fff;
    font-family:arial,helvetica,sans-serif;
    }
    #map {      padding:0;      margin:0;      height:500px;    }

    #rightPane {
    font-size:10pt;
    text-align:center;
    width:40%;
    overflow:none;
    }



</style>

<!--The viewport meta tag is used to improve the presentation and behavior of the samples on iOS devices-->
<meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>

<script type="text/javascript">
    var app = {};
    require([
        "esri/map",
        "extras/MH_UniqueSetup", "extras/MH_CreateQueryDef", "extras/MH_Query4Results", "extras/MH_Query4Summary", "extras/MH_MapSetup_prjReport", "extras/MH_Query4PrjReportResults",
        "esri/urlUtils", "dojo/_base/array", "dojo/parser", "esri/config", "dojo/dom", "dojo/dom-class", "dojo/on",
        "dijit/form/CheckBox",
        "dojo/_base/Color",
        "dojo/mouse", "dojo/query", "dojox/grid/DataGrid",
        "esri/arcgis/utils",
        "dijit/layout/BorderContainer", "dijit/layout/ContentPane",
        "dijit/layout/AccordionContainer", "dojo/domReady!"
        ],

    function (Map,
                MH_UniqueSetup, MH_CreateQueryDef, MH_Query4Results, MH_Query4Summary, MH_MapSetup_prjReport, MH_Query4PrjReportResults,
                urlUtils, arrayUtils, parser, esriConfig, dom, domClass, on,
                CheckBox,
                Color, mouse, query, DataGrid) {

        var strURL = "https://www.sciencebase.gov/arcgis/rest/services/Catalog/530fdba2e4b0686a920d1eea/MapServer"

        app.gPjrReportQuery = new MH_Query4PrjReportResults({ strURL: strURL }); // instantiate the class

        var tokens = getTokens
        var strPRJ_ID = getTokens()['PRJ_ID']; //?RButton=true



        if (strPRJ_ID) {
            var div = document.getElementById('querycontent');
            div.innerHTML += "\n<br>" + strPRJ_ID;
        } else {
            strPRJ_ID = 293;
            var div = document.getElementById('querycontent');
            div.innerHTML += "\n<br>" + strPRJ_ID;
        }
        parser.parse();
        app.gPjrReportQuery.RunReport("ProjectID = " + strPRJ_ID, [gridContacts, gridContactOrgsOnly, gridProposals,
                                                                    gridConservationTargetsSPP, gridConservationTargetsOther,
                                                                    gridDeliverables, gridDeliverablesSupWebinarsPages]);  // this needs sync'ing with the grids below, the div's below, and the array in the MH_Query4PrjReportResults
        //app.gPjrReportQuery.RunReport("ProjectID = " + strPRJ_ID, [gridConservationTargets]);  // this needs sync'ing with the grids below, the div's below, and the array in the MH_Query4PrjReportResults
        app.pMapSup_prjReport = new MH_MapSetup_prjReport({ strQuery: "ProjectID = " + strPRJ_ID, dblExpandNum: 0.8 }); // instantiate the class
        app.pMapSup_prjReport.Phase1(); 
        function getTokens() {
            var tokens = [];
            var query = location.search;
            query = query.slice(1);
            query = query.split('&');
            $.each(query, function (i, value) {
                var token = value.split('=');
                var key = decodeURIComponent(token[0]);
                var data = decodeURIComponent(token[1]);
                tokens[key] = data;
            });
            return tokens;
        }
        function nameFormatter(value, rowIndex) {
            console.log(value);
            return value;
        }

    });
</script>


<script type="text/javascript">
    $(document).ready(function () {
        hljs.tabReplace = '    '; //        syntax highlighter
        hljs.initHighlightingOnLoad();
        $.fn.slideFadeToggle = function (speed, easing, callback) { return this.animate({ opacity: 'toggle', height: 'toggle' }, speed, easing, callback); };

        $('.collapsible').collapsible({             //collapsible management
            defaultOpen: 'page_collapsible1,body-section2,body-section3',
            cookieName: 'nav',
            speed: 'slow',
            animateOpen: function (elem, opts) { //replace the standard slideUp with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            animateClose: function (elem, opts) { //replace the standard slideDown with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            loadOpen: function (elem) { //replace the standard open state with custom function
                elem.next().show();
            },
            loadClose: function (elem, opts) { //replace the close state with custom function
                elem.next().hide();
            }
        });
        $('.page_collapsible').collapsible({
            defaultOpen: '',
            cookieName: 'body2',
            speed: 'slow',
            animateOpen: function (elem, opts) { //replace the standard slideUp with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            animateClose: function (elem, opts) { //replace the standard slideDown with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            loadOpen: function (elem) { //replace the standard open state with custom function
                elem.next().show();
            },
            loadClose: function (elem, opts) { //replace the close state with custom function
                elem.next().hide();
            }
        });

        if ($('#page_collapsible1').collapsible('collapsed')) {
            $('#page_collapsible1').collapsible('open');
        }
        if ($('#Div4').collapsible('collapsed')) {
            $('#Div4').collapsible('open');
        }

        function openAll() { $('.page_collapsible').collapsible('openAll'); } //assign open/close all to functions
        function closeAll() { $('.page_collapsible').collapsible('closeAll'); }

        //listen for close/open all
        $('#closeAll').click(function (event) {
            event.preventDefault();
            closeAll();
        });
        $('#openAll').click(function (event) {
            event.preventDefault();
            openAll();
        });

    });
</script>

</head>



<body class="soria">


<div id="WideContent">
    <a href="#" id="closeAll" title="Close all" style="font-size:.65em;">Close All</a> | <a href="#" id="openAll" title="Open All" style="font-size:.65em;">Open All</a>
    <!-- collapsible -->
    <div class="page_collapsible" id="page_collapsible1">Project Information<span></span></div>
        <div class="container"  id="container1" >
            <div id="divTitle"></div>
                    <hr>
            <div id="divDescription"></div>
                    <hr>
            <div id="dTotalAllocatedbyLCCbyYear"></div>
                    <hr>
            <div id="divPI"></div>
            <div id="divLeadOrg"></div>
                    <hr>
            <div id="divFundingDispersal"></div>
                    <hr>
            <div class="WideContent" id="content1" >
            </div>
        </div>
    <!-- end collapsible -->

    <!-- collapsible -->
    <div class="page_collapsible" id="body-section2">Project Detail<span></span></div>
    <div class="container">
    <div id="gridDivProposals"></div><br />
       <div id="divProposals"></div>                    <hr>
        <div id="divStart"></div>
        <div id="divEnd"></div>                   <hr>
        <div id="divDeliverables"></div>            <hr>
        <div id="divEcotypicArea"></div>                    <hr>
        <div id="divGoals"></div>                    <hr>
        <div id="divStressors"></div>                    <hr>
        <div id="gridDivConservationTargetsSPP"></div><br />
        <div id="gridDivConservationTargetsOther"></div><br />
    </div>

    <div class="page_collapsible" id="Div1">Contact Detail<span></span></div>
    <div class="container">
            <div id="gridDivContacts"></div><br />
            <div id="gridDivContactOrgsOnly"></div><br />

    </div>

 <!-- collapsible -->
    <div class="page_collapsible" id="Div13">Products/Deliverables<span></span></div>
    <div class="container">
            <div id="gridDivDeliverablesSupWebinarsPages"></div><br />
            <div id="gridDivDeliverables"></div><br />
    </div>

    <!-- end collapsible -->

    <!-- end collapsible -->
    <!-- collapsible -->
    <div class="page_collapsible" id="body-section3">Map<span></span></div>
    <div class="container">
        <div class="content" id="querycontent">
             
            <p>
                MapService URL: <a href="https://www.sciencebase.gov/arcgis/rest/services/Catalog/530fdba2e4b0686a920d1eea/MapServer" title="rest endpoing">https://www.sciencebase.gov/arcgis/rest/services/Catalog/530fdba2e4b0686a920d1eea/MapServer</a>
            </p>
        </div>
    </div>
  
            <table dojotype="dojox.grid.DataGrid" style="height:200px;" jsid="gridContacts" id="gridContacts" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="PersonName" width="400px" height="60px">Name</th>
                  <th field="Contact_Type" width="150" height="60px">Type</th>
                  <th field="GroupName" width="auto"  height="60px">Affiliation</th>
                  <!--<th field="prj_priority" width="80px">Priority</th>-->
                  <!--<th field="uri" width="auto">Email</th> -->             
                </tr>
              </thead>
            </table>

           <table dojotype="dojox.grid.DataGrid" style="height:300px" jsid="gridContactOrgsOnly" id="gridContactOrgsOnly" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="GroupName" width="450" height="60px">Group Name (individuals not specified)</th>
                  <th field="Contact_Type" width="200" height="60px">Type</th>
    
                </tr>
              </thead>
            </table>

          <table dojotype="dojox.grid.DataGrid" data-dojo-props="escapeHTMLInData:false" style="height:450px;width:500px;" jsid="gridProposals" id="Table1" selectable="true" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="Fund_Year" width="120" height="60px">Fund Year</th>
                  <th field="deliverable_title" width="200" height="60px">Title</th>
                  <th field="uri" hidden="true" width="200" height="60px">Weblink</th>
                </tr>
              </thead>
            </table>


            <table dojotype="dojox.grid.DataGrid" style="height:200px;" jsid="gridConservationTargetsSPP" id="gridConservationTargetsSPP" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="CommonName" width="240px" height="auto">Species Conservation Targets</th>
                  <th field="ESA_Status" width="280px" height="60px">ESA Status</th>
                  <th field="TierName" width="50px"  height="30px">Tier</th>
                  <th field="PrimaryLCCTargetType" width="auto">LCC Identified</th>              
                </tr>
              </thead>
            </table>

            <table dojotype="dojox.grid.DataGrid" style="height:200px;" jsid="gridConservationTargetsOther" id="gridConservationTargetsOther" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="CommonName" width="400px" height="auto">Habitats, Ecosystems, & Processess Consv. Targets</th>
                  <th field="ConsvTargetTypeName" width="150px">Type</th>
                  <th field="PrimaryLCCTargetType" width="auto">LCC Identified</th>              
                </tr>
              </thead>
            </table>

            <table dojotype="dojox.grid.DataGrid" style="height:200px;" jsid="gridDeliverables" id="Table2" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="deliverable_title" width="550px">Title</th>
                  <th field="Fund_Year" width="90px" height="auto">Fund Year</th>
                  <th field="duedate" width="auto">Due Date</th>              
                  <th field="DelivType" width="auto">Deliv Type</th>    
                  <th field="Deliverable_Received" width="auto">Received</th>    
                  <th field="deliverableid" hidden="true">deliverableid</th>
                </tr>
              </thead>
            </table>

            <table dojotype="dojox.grid.DataGrid" style="height:200px;" jsid="gridDeliverablesSupWebinarsPages" id="Table3" selectionMode="none" style="font-size:.75em;">
             <thead>
                <tr>
                  <th field="deliverable_title" width="150px">Title</th>
                  <th field="Fund_Year" width="90px" height="auto">Fund Year</th>
                  <th field="duedate" width="auto">duedate</th>              
                  <th field="DelivType" width="auto">Deliv Type</th>    
                  <th field="deliverableid" hidden="true">deliverableid</th>
                </tr>
              </thead>
            </table>


            <div id="mapPrjReport"
                data-dojo-type="dijit/layout/ContentPane"
                data-dojo-props="region:'center'"
                style="overflow:hidden; background-color:rgb(255, 255, 255);">
                    <img id="loadingImg" src="images/loading.gif" style="position:absolute; right:50%; top:50%; z-index:100;" />
            </div>

</div>

</body>


</html>
