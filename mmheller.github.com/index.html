<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Draft - GNLCC Project Tracking System Public Website</title>
    <link rel="stylesheet" href="https://js.arcgis.com/3.14/dijit/themes/soria/soria.css">
    <link rel="stylesheet" href="https://js.arcgis.com/3.14/esri/css/esri.css"/>
    <link rel="stylesheet" href="css/github.css" type="text/css" />
    <link rel="stylesheet" href="css/collapse.css" type="text/css" />
    <link rel="stylesheet" href="css/panel.css" type="text/css" />
    <link rel="stylesheet" href="https://js.arcgis.com/3.14/dojox/grid/resources/Grid.css"/>
    <link rel="stylesheet" href="https://js.arcgis.com/3.14/dojox/grid/resources/soriaGrid.css"/>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />

    <script type="text/javascript">var dojoConfig = {paths: { extras: location.pathname.replace(/\/[^/]+$/, "") + "/extras" }};</script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
    <script type="text/javascript" src="http://softwaremaniacs.org/media/soft/highlight/highlight.pack.js"></script>
    <script type="text/javascript" src="extras/jquery.cookie.js"></script>
    <script type="text/javascript" src="extras/jquery.collapsible.js"></script>
    <script type="text/javascript" src="https://js.arcgis.com/3.14/"></script>

<style>
    ul.ui-autocomplete.ui-menu{width:600px;font-size:.7em;} /* this controls the style of the results in the autocomplete  */
    .soria .NavigationForm .content {font-size:.3em;}
    .soria .dojoxGridRowOver .dojoxGridCell {border: 0px solid; color:#000000; background-color: #B2B2B2}
    .soria .dojoxGridCell {border: 0px solid; color:#000000; font-size:1.2em;}  /* this controls style of grid cells */
    .soria .dojoxGridHeader .dojoxGridCell {background-image: url("images/title-bar.png"); border: 0px solid;}
    .soria .dojoxGrid {font-family: Arial, Helvetica, sans-serif;}
    .dojoxGridView {left:0px;}
    
    .esriPopup .titlePane {padding-left: 20;}
    .esriPopup {right: 30;}
    
    table { display: table; border-collapse: separate; border-spacing: 0px; border-color: white;}
    
    div.scroll {    /* this controls content style in the scroll bars   */
        height: 250px; overflow-y: scroll; background:#FFFFFF; margin: 0; padding:10px; font-size:1em; line-height:1.5em; font-family: Arial, Helvetica, sans-serif;}

    html,body {height:100%;width:100%;margin:0;}
    
    body {background-color:#fff;font-family:arial,helvetica,sans-serif;}

    .HTMLTable_styleMiddle    {    width: 13px;background-color: #FFFFFF}
    .HTMLTable_styleLeft    {    width: 350px; border-bottom-style: solid; border-width: thick; border-color: #FFFFFF;}
    .HTMLTable_BannerRow    {   width: 350px; background-color: #5B7E8A; color: #FFFFFF; font-weight: bold}

    #map {      padding:0;      margin:0;      height:800px;    }

    #btn_clear, #btn_Print_Friendly { border: none; padding:5px; color:white; background-color:gray; -webkit-border-radius:5px;
                                    -moz-border-radius:5px; border-radius:2px; box-shadow:0px 0px 2px #555; font-weight:bold; font-size:70%;    }

    #btn_clear:hover, #btn_Print_Friendly:hover {box-shadow:0px 0px 3px #555;}
</style>

<!--The viewport meta tag is used to improve the presentation and behavior of the samples on iOS devices-->
<meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>

<script type="text/javascript">
//    dojo.require("dijit.layout.TabContainer");
//    dojo.require("dijit.layout.ContentPane");
    var app = {};
    require([
        "esri/map",
        "extras/MH_UniqueSetup", "extras/MH_CreateQueryDef", "extras/MH_Query4Results", "extras/MH_Query4Summary", "extras/MH_MapSetup",
        "esri/urlUtils", "dojo/_base/array", "dojo/parser", "esri/config", "dojo/dom", "dojo/dom-class", "dojo/on",
        "dijit/form/CheckBox",
        "dojo/_base/Color",
        "dojo/mouse", "dojo/query", "esri/geometry/webMercatorUtils", "esri/dijit/BasemapGallery", "esri/dijit/Legend",
        "esri/arcgis/utils",
        "dijit/layout/BorderContainer", "dijit/layout/ContentPane",
        "dijit/layout/AccordionContainer", "dojo/domReady!"
        ],

    function (Map,
                MH_UniqueSetup, MH_CreateQueryDef, MH_Query4Results, MH_Query4Summary, MH_MapSetup,
                urlUtils, arrayUtils, parser, esriConfig, dom, domClass, on,
                CheckBox,
                Color, mouse, query, webMercatorUtils, BasemapGallery, Legend) {

        var strURL = "https://www.sciencebase.gov/arcgis/rest/services/Catalog/530fdba2e4b0686a920d1eea/MapServer"
        app.gCQD = new MH_CreateQueryDef({}); // instantiate the class
        app.gSup = new MH_UniqueSetup({}); // instantiate the class

        on(dom.byId("btn_clear"), "click", btn_clear_click);
        on(dom.byId("btn_Print_Friendly"), "click", btn_Print_Friendly_click);

        app.gQuery = new MH_Query4Results({ strURL: strURL, m_grid: grid }); // instantiate the class
        app.gQuerySummary = new MH_Query4Summary({ strURL: strURL }); // instantiate the class
        var tokens = getTokens

        parser.parse();
        app.pMapSup = new MH_MapSetup({}); // instantiate the class
        app.pMapSup.Phase1();
        app.pMapSup.Phase3();

        app.gQuery.SendQuery4ProjectResults("OBJECTID > 0", grid);

        document.getElementById("page_collapsibleMapDestination").appendChild(document.getElementById("map"));  //move the grid to the designated div, grids need to be built outside the collapsable panel otherwise risk not rendering properly

        function getTokens() {
            var tokens = [];
            var query = location.search;
            query = query.slice(1);
            query = query.split('&');
            $.each(query, function (i, value) {
                var token = value.split('=');
                var key = decodeURIComponent(token[0]);
                var data = decodeURIComponent(token[1]);
                tokens[key] = data;
            });
            return tokens;
        }

        function btn_clear_click() {
            document.getElementById("loc").value = "";
            if ($('#page_collapsible1').collapsible('collapsed')) {
                $('#page_collapsible1').collapsible('open');
            }
            app.gQuery.strQuery = null;
            app.gQuery.SendQuery4ProjectResults("OBJECTID > 0", grid);
            app.map.graphics.clear();
            app.map.infoWindow.destroy();
        }

        function btn_Print_Friendly_click() {
            var strHTML = "indexPF.html"

            if (app.gQuery.strQuery !== null) {
                strHTML += "?Prjs=" + app.gQuery.strQuery.replace("ProjectID in (", "").replace(")", "");
            }
            window.open(strHTML);
        }
    });
</script>


<script type="text/javascript">

    $(document).ready(function () {
        hljs.tabReplace = '    '; //        syntax highlighter
        hljs.initHighlightingOnLoad();
        $.fn.slideFadeToggle = function (speed, easing, callback) { return this.animate({ opacity: 'toggle', height: 'toggle' }, speed, easing, callback); };

        $('.collapsible').collapsible({             //collapsible management
            defaultOpen: 'page_collapsible1,body-section2,body-section3',
            cookieName: 'nav',
            speed: 'slow',
            animateOpen: function (elem, opts) { //replace the standard slideUp with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            animateClose: function (elem, opts) { //replace the standard slideDown with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            loadOpen: function (elem) { //replace the standard open state with custom function
                elem.next().show();
            },
            loadClose: function (elem, opts) { //replace the close state with custom function
                elem.next().hide();
            }
        });
        $('.page_collapsible').collapsible({
            defaultOpen: '',
            cookieName: 'body2',
            speed: 'slow',
            animateOpen: function (elem, opts) { //replace the standard slideUp with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            animateClose: function (elem, opts) { //replace the standard slideDown with custom function
                elem.next().slideFadeToggle(opts.speed);
            },
            loadOpen: function (elem) { //replace the standard open state with custom function
                elem.next().show();
            },
            loadClose: function (elem, opts) { //replace the close state with custom function
                elem.next().hide();
            }
        });

        if ($('#page_collapsible1').collapsible('collapsed')) {
            $('#page_collapsible1').collapsible('open');
        }


        function openAll() { $('.page_collapsible').collapsible('openAll'); } //assign open/close all to functions
        function closeAll() { $('.page_collapsible').collapsible('closeAll'); }

        //listen for close/open all
        $('#closeAll').click(function (event) {
            event.preventDefault();
            closeAll();
        });
        $('#openAll').click(function (event) {
            event.preventDefault();
            openAll();
        });

    });
</script>

</head>
<body class="soria">

       <!--     <div data-dojo-type="dijit/layout/BorderContainer" data-dojo-props="design:'headline'" style="width:100%; height:100%;">
                <div id="bot" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'top', splitter:true" style="height:50%">
                  <div id="ResultsTableNode"></div>
                </div>
              </div>-->
       

<!--<h1>DRAFT - GNLCC Projects and Deliverables Public Search and Report Tool - DRAFT</h1>-->
<!-- left column collapsible -->


<div id="navigation">
    <form id="NavigationForm">
        <input id="btn_clear" type="button"  value="Reset Search">
        <input id="btn_Print_Friendly" type="button"  value="Print Freindly">
        <br/><br/>

        <font size="2%" color="#2E2E2E">Keyword Search</font>
        <div id="autocompleteSearch">
            <input id="loc" class="textbox" type="text"  title="Enter portion of...
            Project Title, Project Lead, Keywords, 
            Partner Organizaitons
        and wait a moment for a pick list"/><br />
            &nbsp;
        </div>

        <div class="collapsible" id="section3">Year Funded<span></span></div>
        <div class="container"><div class="content" id="section3content"></div></div>

        <div class="collapsible" id="section5">Conservation Target<span></span></div>
        <div class="container"><div class="scroll" id="section5content"></div></div>

        <div class="collapsible" id="section7">Conservation Goal<span></span></div>
        <div class="container"><div class="content" id="section7content"></div></div>

        <div class="collapsible" id="section10">Stressor<span></span></div>
        <div class="container"><div class="content" id="section10content"></div></div>

        <div class="collapsible" id="section8">Deliverable Type<span></span></div>
        <div class="container"><div class="scroll" id="section8content"></div></div>

        <div class="collapsible" id="section1">Ecotypic Area<span></span></div>
        <div class="container" ><div class="content" id="section1content"></div></div>

        <div class="collapsible" id="section2">Lead Organization<span></span></div>
        <div class="container"><div class="scroll" id="section2content"></div></div>


        <div class="collapsible" id="section4">Funding Recipient<span></span></div>
        <div class="container"><div class="scroll" id="section4content"></div></div>
        
        <div class="collapsible" id="section6">Funding Recipient Type<span></span></div>
        <div class="container"><div class="content" id="section6content"></div></div>

        <div class="collapsible" id="section9">Project In-Kind/Match<span></span></div>
        <div class="container"><div class="scroll" id="section9content"></div></div>

        <div class="collapsible" id="section11">Project Affiliate<span></span></div>
        <div class="container"><div class="scroll" id="section11content"></div></div>
        
        <div class="collapsible" id="section12">Project Status<span></span></div>
        <div class="container"><div class="content" id="section12content"></div></div>

        <div class="collapsible" id="section13">State/Province<span></span></div>
        <div class="container"><div class="content" id="section13content"></div></div>


        <div class="collapsible" id="section14">Project Fund Type<span></span></div>
        <div class="container"><div class="content" id="section14content"></div></div>
        <div class="collapsible" id="Div1">Funding Amount (not yet enabled)<span></span></div>
        <div class="container"><div class="content" id="Div2"></div></div>
        <div class="collapsible" id="Div3">Map Layers<span></span></div>
        <div class="container">
            <div class="content" id="Div4">
                <form id="toggleForm">
                    <div id="toggle" style="padding: 2px 2px;"></div>
                    <br />
                    <div id="legendDiv"></div>
                </form>

            </div>
        </div>

        <br />
       <!-- <input id="btn_clear2" type="button"  value="Reset" 
                style="border-style: none; padding: 5px; font-size: small;">-->


    </form>
</div>


<!-- /left column collapsible -->

<div id="content">
         <a href="#" id="closeAll" title="Close all" style="font-size:.65em; text-decoration: none; color:#2E2E2E;">Close All Results</a> |
          <a href="#" id="openAll" title="Open All Results" style="font-size:.65em; text-decoration: none; color:#2E2E2E;">Open All Results</a>
    

    <!-- collapsible -->
    <div class="page_collapsible" id="page_collapsible1">Results<span></span></div>
        <div class="container"  id="container1" >
            <table dojotype="dojox.grid.DataGrid" style="height:600px;" jsid="grid" id="grid" selectionMode="none"">
             <thead>
                <tr>
                  <th field="Fiscal_Years_of_Allocation" width="50" height="60px">FY    </th>
                  <th field="ProjectID" hidden="true">ProjectID</th>
                  <th field="Prj_Title" width="290px" height="60px">Project Title</th>
                  <th field="LeadName_LastFirst" width="135px">Project Lead</th>
                  <th field="PI_Org" width="auto">Affiliation</th>      
                          
                </tr>
              </thead>
            </table>
            <div class="content" id="content1" >
                
            </div>
        </div>
    <!-- end collapsible -->

    <!-- collapsible -->
    <div class="page_collapsible" id="body-section2">Results Summary<span></span></div>
    <div class="container">

<table style="width:100%; background-color: #F3F3F3;">
        <tr>
            <td class="HTMLTable_BannerRow">
                <img src="images/funding.png" alt="Funding" height="30" width="30">
                    
                &nbsp;Funds Allocated&nbsp;</td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
            <td class="HTMLTable_BannerRow">
                <img src="images/leverage.png" alt="leverage"  height="30">
                Partner Contributions</td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dTotalAllocatedbyLCC"></div>
                </td>
            <td class="HTMLTable_styleMiddle">
                </td>
            <td class="HTMLTable_styleLeft">
                <div id="dTotalInKindMatch"></div>
                </td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dTotalAllocatedbyLCCbyYear">
                </div>
            </td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
            <td class="HTMLTable_styleLeft" rowspan="5">
                <div id="dNumberofInKindOrgs"></div> </td>
        </tr>

        <tr>
            <td class="HTMLTable_styleLeft">
                    <div id="dNumberOfFundingRecipients"></div>  
               </td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dFundRecipientTypes"></div></td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
        </tr>
        <tr>
            <td class=HTMLTable_styleLeft>
                <div id="dYearsFunded">
                </div>
            </td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dNumberOfProjectContacts"></div></td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
        </tr>

<!--        <tr>
            <td class="HTMLTable_styleLeft">
                &nbsp;</td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
        </tr>-->
        <tr>
            <td class="HTMLTable_BannerRow">
                <img src="images/target.png" alt="target"  height="30"> Conservation Goals and Targets</td>
            <td class="HTMLTable_styleMiddle">
                </td>
            <td class="HTMLTable_BannerRow">
                <img src="images/checkbox.png" alt="checkbox"  height="30"> Deliverables</td>
        </tr>
        <tr>
            <td class=HTMLTable_styleLeft>
                <div id="dTotalNumberofConsvTargets">
                </div>
            </td>
            <td class="HTMLTable_styleMiddle">
                </td>
            <td class="HTMLTable_styleLeft">
                <div id="dNumberofDeliverables">
                </div>
            </td>
        </tr>

        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dEcotypicAreas"></div></td>
            <td class="HTMLTable_styleMiddle">
                </td>
            <td class="HTMLTable_styleLeft">
                <div id="dDeliverabletype">
                </div></td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dStressors"></div>  </td>
            <td class="HTMLTable_styleMiddle">
                &nbsp;</td>
            <td class="HTMLTable_styleLeft">
                <div id="dPrjStatus"></div>
            </td>
        </tr>
        <tr>
            <td class="HTMLTable_styleLeft">
                <div id="dGoals"></div></td>
            <td class="HTMLTable_styleMiddle">
                </td>
            <td class="HTMLTable_styleLeft">
                </td>
        </tr>
    </table>

    </div>
    <!-- end collapsible -->
    <!-- collapsible -->
    <div class="page_collapsible" id="page_collapsibleMap">Map Summary<span></span></div>
    <div class="container">
        <div id="page_collapsibleMapDestination" style="position:relative" >
        </div>

    </div>
            <div id="map"
                data-dojo-type="dijit/layout/ContentPane"
                data-dojo-props="region:'center'"
                style="overflow:hidden; background-color:rgb(255, 255, 255); z-index:49; ">
                    <img id="loadingImg" src="images/loading.gif" style="position:absolute; right:50%; top:50%; z-index:100;" />
                    <div id="panelBasemaps" class="panelBasemaps bg rounded shadow" >		    <!-- Panel Basemaps -->
	                    <div id="basemapTitle"><img src="images/basemaps.png" height="30" title="Switch Base Map" /></div>
	                    <div id="basemapContent">
		                    <div id="basemapGallery" ></div>
	                    </div>
                    </div>
                    <div id="txt_xyCoords" style="position:absolute; left:25px; bottom:1px; color:#404040; z-index:50; font-size:11px"></div>
            </div>
</div>
</body>
</html>
